# 简易温度监控上位机软件需求规格说明书

## 1. 项目概述
### 1.1 项目背景
为了实时监控生产环境的温度变化，需要开发一款基于 C# 的上位机软件，通过串口与下位机（单片机）进行通信，采集温度数据并进行显示、记录和报警。

### 1.2 项目目标
- 实现与下位机的稳定通信。
- 实时显示温度数据。
- 提供数据记录与导出功能。
- 温度异常时进行报警提示。
- 提供友好的用户界面。

### 1.3 适用范围
适用于实验室、小型工厂、仓库等需要对温度进行监控的场景。

---

## 2. 系统架构
### 2.1 硬件环境
- PC 机：Windows 10/11。
- 下位机：STM32F103。
- 温度传感器：DS18B20。
- 通信方式：RS-232 串口。

### 2.2 软件架构
采用分层架构：
1. **UI 层**：Windows Forms 界面。
2. **通信层**：串口通信模块。
3. **数据处理层**：数据解析与处理。
4. **数据存储层**：CSV 文件存储。

---

## 3. 详细需求
### 3.1 功能需求
1. **串口通信**
   - 自动检测可用串口。
   - 支持波特率设置（9600、19200、38400、115200）。
   - 连接/断开控制。

2. **数据采集与显示**
   - 实时显示温度数据（数字 + 图表）。
   - 显示数据更新时间。

3. **数据记录**
   - 记录数据到 CSV 文件。
   - 每条记录包含时间戳和温度值。
   - 支持手动开始/停止记录。

4. **报警功能**
   - 设置温度上下限。
   - 超过阈值时进行视觉和声音报警。

5. **历史数据查看**
   - 显示最近的温度记录。
   - 支持导出数据。

### 3.2 性能需求
- 数据更新频率：1 秒/次。
- 系统响应时间：< 0.5 秒。
- 连续运行稳定性：≥ 72 小时。

### 3.3 接口需求
- 串口通信接口：符合 RS-232 标准。
- 数据格式：`T:23.5\r\n`。

---

## 4. 数据库设计（CSV）
每条记录格式：

```
时间戳,温度值(℃)
2023-10-14 10:00:00,23.5
2023-10-14 10:00:01,23.6
```

---

## 5. 模块设计
### 5.1 串口通信模块
- 功能：管理串口连接和数据收发。
- 主要类：`SerialCommunicator`。
- 方法：
  - `ListAvailablePorts()`
  - `Connect(string portName, int baudRate)`
  - `Disconnect()`
  - `SendData(string data)`
  - `DataReceived` 事件。

### 5.2 数据处理模块
- 功能：解析收到的数据并触发相应事件。
- 主要类：`DataProcessor`。
- 方法：
  - `ParseData(string rawData)`
  - `CheckAlarm(float temperature)`

### 5.3 数据记录模块
- 功能：管理数据记录和文件存储。
- 主要类：`DataLogger`。
- 方法：
  - `StartLogging(string filePath)`
  - `StopLogging()`
  - `LogData(float temperature)`

### 5.4 UI 模块
- 功能：用户界面和交互。
- 主要窗体：
  - `MainForm`：主界面。
  - `SettingsForm`：设置界面。

---

## 6. UI 设计
### 6.1 主界面布局
- 顶部：串口设置区域（端口选择、波特率、连接按钮）。
- 中部：实时温度显示（大号数字 + 曲线图）。
- 底部：历史数据表格 + 记录控制按钮。

### 6.2 颜色与风格
- 主色调：蓝色（#1E88E5）。
- 温度正常：绿色。
- 温度异常：红色。
- 中性状态：灰色。

---

## 7. 测试计划
### 7.1 单元测试
- 串口通信模块测试。
- 数据解析模块测试。
- 数据记录模块测试。

### 7.2 集成测试
- 通信 + 数据处理联合测试。
- UI 与业务逻辑交互测试。

### 7.3 系统测试
- 连续运行测试（72 小时）。
- 异常处理测试。
- 性能测试。

---

## 8. 部署方案
- 软件打包为 Windows 安装程序。
- 支持 Windows 10/11 系统。
- 安装后自动创建桌面快捷方式。

---

## 9. 维护计划
- 定期更新软件（每季度一次）。
- 提供技术支持邮箱。
- 记录用户反馈并进行改进。
